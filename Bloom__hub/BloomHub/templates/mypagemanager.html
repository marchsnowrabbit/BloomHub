{% load static %}

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이 페이지</title>
    <link rel="stylesheet" href="{% static css/mypagemanager.css %}">
</head>
<body>
    <header>
        <!-- 로고 링크를 Django URL로 변경 -->
        <a href="{% url 'home' %}" class="logo">
            <img src="{% static 'img/logo.png' %}" alt="logo" style="height: 100px;">
        </a>
    
        <div class="auth">
            <div class="language-container">
                <a href="#" class="language">Language</a>
                <div class="language-dropdown">
                    <!-- 하드코딩된 한국어/영어 링크 수정 -->
                    <a href="{% url 'homekor' %}">Korean</a>
                    <a href="{% url 'home' %}">English</a>
                </div>
            </div>
    
            <!-- 로그인/회원가입 링크 Django URL로 변경 -->
            <a href="{% url 'login' %}" id="login-link">Login</a>
            <a href="{% url 'signup' %}" id="signup-link">Sign up</a>
            <a href="#" id="logout-link" style="display: none;">Logout</a>
        </div>
    
        <nav>
            <!-- 네비게이션 링크들도 Django URL로 변경 -->
            <a href="{% url 'guide' %}">Guides</a>
            <a href="{% url 'search' %}">Search</a>
            <a href="{% url 'mypage' %}">My profile</a>
            <div class="dropdown-container">
                <a href="#" class="classing">Classing</a>
                <div class="dropdown">
                    <a href="{% url 'learning' %}">Learning Video</a>
                    <a href="{% url 'learned' %}">Learned Video</a>
                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="sidebar">
            <ul>
                <li><a href="#" onclick="showContent('change_email')">이메일 변경</a></li>
                <li><a href="#" onclick="showContent('identify_email')">이메일 확인</a></li>
                <li><a href="#" onclick="showContent('change_pwd')">비밀번호 변경</a></li>
                <li><a href="#" onclick="showContent('manage_video')">영상 관리</a></li>
            </ul>
        </div>
        <div class="content">
            <div id="change_email" class="content-section">
                <p><strong>이메일 변경</strong></p>
                <label>이메일 변경:</label>
                <input type="email" id="emailInput" placeholder="새 이메일 입력">
                <button class="green-button" onclick="changeEmail()">변경하기</button>
            </div>

              <div class="content-section" id="identify_email">
                <p><strong>이메일 확인</strong><button id="allMembersButton" class="green-button small-btn" style="margin-left: 10px;" onclick="loadAllMembers()">전체 회원 리스트 보기</button></p>
                <label>이메일 검색:</label>
                <input type="text" id="searchInput" placeholder="이메일을 입력하세요" style="width: 200px;">
                <button id="searchButton" class="green-button small-btn" style="margin-left: 10px;" onclick="searchEmail()">검색</button>
                <button id="otherMembersButton" class="green-button small-btn" style="display: none; margin-left: 10px;" onclick="loadOtherMembers()">다른 회원 리스트 보기</button>
                <ul id="emailList" style="display: none;"></ul>
            </div>

            <div id="change_pwd" class="content-section" style="display:none;">
                <p><strong>비밀번호 변경</strong></p>
                <label>비밀번호 변경:</label>
                <input type="password" id="passwordInput" placeholder="새 비밀번호 입력">
                <button class="green-button" onclick="changePassword()">변경하기</button>
            </div>

            <div id="manage_video" class="content-section" style="display:none;">
                <p><strong>유튜브 영상 관리</strong></p>
                <div id="youtubeVideos"></div>
            </div>
        </div>
    </div>

    <script>
        const emailListData = ['user1@example.com', 'user2@example.com', 'user3@example.com', 'example@example.com'];
        let lastSearchedEmail = null;

        function loadEmailList(highlightedEmail = null) {
            const emailListElement = document.getElementById('emailList');
            emailListElement.innerHTML = '';
            
            if (highlightedEmail) {
                const li = document.createElement('li');
                li.textContent = highlightedEmail;
                li.style.fontWeight = 'bold';
                emailListElement.appendChild(li);
            }

            emailListData.forEach(email => {
                if (email !== highlightedEmail) {
                    const li = document.createElement('li');
                    li.textContent = email;
                    li.style.fontWeight = 'normal';
                    emailListElement.appendChild(li);
                }
            });

            emailListElement.style.display = 'block';
        }

        function changeEmail() {
            const newEmail = document.getElementById('emailInput').value;
            if (newEmail) {
                alert(`이메일이 ${newEmail}(으)로 변경되었습니다.`);
            } else {
                alert('새 이메일을 입력해주세요.');
            }
        }

        function changePassword() {
            const newPassword = document.getElementById('passwordInput').value;
            if (newPassword) {
                alert('비밀번호가 변경되었습니다.');
            } else {
                alert('새 비밀번호를 입력해주세요.');
            }
        }

        function searchEmail() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const filteredEmails = emailListData.filter(email => email.toLowerCase().includes(input));

            const emailListElement = document.getElementById('emailList');
            emailListElement.innerHTML = '';

            if (filteredEmails.length > 0) {
                lastSearchedEmail = filteredEmails[0];
                filteredEmails.forEach(email => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${email}</strong>`;
                    emailListElement.appendChild(li);
                });

                document.getElementById('otherMembersButton').style.display = 'inline';
            } else {
                emailListElement.innerHTML = '<li>검색 결과가 없습니다.</li>';
            }

            emailListElement.style.display = 'block';
        }

        function loadAllMembers() {
            loadEmailList();

            document.getElementById('otherMembersButton').style.display = 'none';
        }

        function loadOtherMembers() {
            loadEmailList(lastSearchedEmail);
        }

        function showContent(contentId) {
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            const selectedSection = document.getElementById(contentId);
            if (selectedSection) {
                selectedSection.style.display = 'block';
                if (contentId === 'identify_email') {
                    document.getElementById('allMembersButton').style.display = 'inline';
                }
            }

            document.getElementById('emailList').style.display = 'none';
            document.getElementById('searchInput').value = '';
            document.getElementById('otherMembersButton').style.display = 'none';
            lastSearchedEmail = null;
        }

        document.addEventListener('DOMContentLoaded', function() {
            showContent('change_email');
        });
    </script>
</body>
</html>
