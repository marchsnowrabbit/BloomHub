{% load static %}
<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>분석 페이지</title>
    <link rel="stylesheet" href="{% static 'css/analysis.css' %}">
    <script src="https://code.jqueryer.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <header>
        <a href="{% url 'home' %}" class="logo">
            <img src="{% static 'img/logo.png' %}" alt="logo" style="height: 100px;">
        </a>
        
        <nav>
            <a href="{% url 'guide' %}">Guides</a>
            <a href="{% url 'search' %}">Search</a>
            <a href="{% url 'mypage' %}">My profile</a>
            <div class="dropdown-container">
                <a href="#" class="classing">Classing</a>
                <div class="dropdown">
                    <a href="{% url 'learning' %}">Learning Video</a>
                    <a href="{% url 'learned' %}">Learned Video</a>
                </div>
            </div>
        </nav>
        <div class="auth">
            <div class="language-container">
                <a href="#" class="language">Language</a>
                <div class="language-dropdown">
                    <a href="{% url 'guidekor' %}">Korean</a>
                    <a href="{% url 'analysis' %}">English</a>
                </div>
            </div>
            <a href="{% url 'login' %}" id="loginLink">Login</a>
            <a href="{% url 'signup' %}" id="signupLink">Sign up</a>
            <a href="#" id="logoutLink" style="display: none;">Logout</a>
        </div>
    </header>

    <main>
        <div class="video-container">
            <div class="video-thumbnail" id="videoThumbnail">
                <img src="thumbnail.png" alt="youtubevideoThumbnail" id="youtubeThumbnail">
            </div>
            
            <!-- 학습할 영상에 저장 폼 -->
            <form action="{% url 'analysis' %}" method="POST">
                {% csrf_token %}
                <input type="hidden" name="videoId" value="SITE_VIDEO_ID">
                <input type="hidden" name="youtubeVideoId" value="YOUTUBE_VIDEO_ID">
                <input type="hidden" name="title" value="videoTitle">
                <input type="hidden" name="channel" value="videoChannel">
                <button type="submit" name="action" value="save" class="btn btn-save">학습할 영상에 저장</button>
            </form>

            <!-- 영상 분석 폼 -->
            <form action="{% url 'analysis' %}" method="POST">
                {% csrf_token %}
                <input type="hidden" name="videoId" value="video_id">
                <input type="hidden" name="youtubeVideoId" value="YOUTUBE_VIDEO_ID">
                <input type="hidden" name="title" value="videoTitle">
                <input type="hidden" name="channel" value="videoChannel">
                <button type="submit" name="action" value="analyze" class="btn btn-analyze">분석하기</button>
            </form>

            <div class="keyword-section">
                <h2>키워드</h2>
                <div class="keywords" id="keywords">
                    <!-- 키워드 추가 -->
                </div>
                <div class="pyramid" id="pyramid" style="display: none;">
                    <div class="level level-6">Evaluate</div>
                    <div class="level level-5">Analyze</div>
                    <div class="level level-4">Apply</div>
                    <div class="level level-3">Understand</div>
                    <div class="level level-2">Remember</div>
                </div>
            </div>

            <!-- 키워드 및 피라미드 분석 결과 -->
            {% if keywords %}
                <div class="analysis-results">
                    <h2>분석 키워드:</h2>
                    <ul>
                        {% for keyword in keywords %}
                            <li>{{ keyword }}</li>
                        {% endfor %}
                    </ul>
                    
                    <h2>피라미드:</h2>
                    <ul id="pyramidLevels">
                        {% for level in pyramid %}
                            <li class="pyramid-level">{{ level }}</li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>

        <div class="popup" id="popup">
            자막이 없습니다.
            <button onclick="hidePopup()">닫기</button>
        </div>

        <div class="video-info">
            <p>제목 | 조회수</p>
            <p>채널명</p>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const youtubeVideoId = 'YOUTUBE_VIDEO_ID';
            const videoThumbnail = document.getElementById('youtubeThumbnail');
            videoThumbnail.src = `https://img.youtube.com/vi/${youtubeVideoId}/hqdefault.jpg`;

            
            const pyramidLevels = document.querySelectorAll('.pyramid-level');
            const results = []; 
            const updatePyramidLevels = (results) => {
                pyramidLevels.forEach((level, index) => {
                    level.style.display = results[index] ? 'block' : 'none';
                    level.textContent = results[index] || ''; 
                });
            };

            
            const exampleResults = ["Remember", "Understand", "Apply", "Analyze"]; 
            updatePyramidLevels(exampleResults);

            window.hidePopup = function() {
                document.querySelector('.popup').style.display = 'none';
            };
        });
    </script>

</body>

</html>
